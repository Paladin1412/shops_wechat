{"code":"(wx.webpackJsonp=wx.webpackJsonp||[]).push([[53],{\"15\":function(e,o,t){\"use strict\";Object.defineProperty(o,\"__esModule\",{\"value\":!0});var h=function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,o){var t=[],n=!0,r=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!o||t.length!==o);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw a}}return t}(e,o);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")},n=function(e,o,t){return o&&defineProperties(e.prototype,o),t&&defineProperties(e,t),e};function defineProperties(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,a,i,g=t(0),u=_interopRequireDefault(g),s=_interopRequireDefault(t(1)),_=t(3),l=t(2),m=_interopRequireDefault(l),p=_interopRequireDefault(t(4)),y=_interopRequireDefault(t(6)),v=_interopRequireDefault(t(252));function _interopRequireDefault(e){return e&&e.__esModule?e:{\"default\":e}}function _possibleConstructorReturn(e,o){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!o||\"object\"!=typeof o&&\"function\"!=typeof o?e:o}var c=p.default.appUtils,b=c.getFileUrl,d=c.navigateToLogin,f=(0,s.default)((function _inherits(e,o){if(\"function\"!=typeof o&&null!==o)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof o);e.prototype=Object.create(o&&o.prototype,{\"constructor\":{\"value\":e,\"enumerable\":!1,\"writable\":!0,\"configurable\":!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}(Home,u.default.Component),n(Home,[{\"key\":\"_constructor\",\"value\":function _constructor(e){(function get(e,o,t){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,o);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,o,t)}if(\"value\"in n)return n.value;var a=n.get;return void 0!==a?a.call(t):void 0})(Home.prototype.__proto__||Object.getPrototypeOf(Home.prototype),\"_constructor\",this).call(this,e),this.state={\"companyList\":[],\"exitPopup\":!1},p.default.appUtils.delay(this,[\"gotoLogin\",\"onExit\",\"enterShop\"]),this.$$refs=new u.default.RefsArray}},{\"key\":\"componentWillReact\",\"value\":function componentWillReact(){}},{\"key\":\"componentDidMount\",\"value\":function componentDidMount(){this.initData()}},{\"key\":\"componentWillUnmount\",\"value\":function componentWillUnmount(){}},{\"key\":\"componentDidShow\",\"value\":function componentDidShow(){wx.hideHomeButton({\"success\":function success(){console.log(\"hide home success\")},\"fail\":function fail(){},\"complete\":function complete(){}})}},{\"key\":\"componentDidHide\",\"value\":function componentDidHide(){}},{\"key\":\"_createData\",\"value\":function _createData(e,o,t){var r=this;this.__state=e||this.state||{},this.__props=o||this.props||{};var n=this.$prefix,a=(0,g.genCompid)(n+\"$compid__105\"),i=h(a,2),u=i[0],s=i[1],_=this.__state,l=_.companyList,m=(_.exitPopup,this.__props.globalStore.data.userInfo),p=!!m.token,c=p?b(m.headImg):y.default.common.default_photo,d=b(p?y.default.common.homeFootprint:y.default.common.homeRecommend),f=l.map(function(e,o){e={\"$original\":(0,g.internal_get_original)(e)};var t=o+1,n=\"gazzz\"+o;return r.anonymousFunc0Map[n]=function(){return r.enterShop(e.$original)},{\"$loopState__temp4\":t,\"_$indexKey\":n,\"$loopState__temp6\":b(e.$original.logo||y.default.register.logoF),\"$loopState__temp8\":b(e.$original.logo||y.default.register.logoF),\"$loopState__temp10\":b(y.default.common.jdLogo),\"$anonymousCallee__9\":e.$original.goodsInfoList.map(function(e,o){return e={\"$original\":(0,g.internal_get_original)(e)},{\"$loopState__temp12\":o+1,\"$loopState__temp14\":b(e.$original.mainImgUrl),\"$original\":e.$original}}),\"$original\":e.$original}});return g.propsManager.set({\"count\":1},s,u),Object.assign(this.__state,{\"anonymousState__temp\":c,\"anonymousState__temp2\":d,\"loopArray40\":f,\"$compid__105\":s,\"styles\":v.default,\"hasRecord\":p,\"userInfo\":m}),this.__state}},{\"key\":\"anonymousFunc0\",\"value\":function anonymousFunc0(e){for(var o,t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.anonymousFunc0Map[e]&&(o=this.anonymousFunc0Map)[e].apply(o,n)}}]),i=a=Home,a.$$events=[\"clickAvatar\",\"onExit\",\"anonymousFunc0\"],a.$$componentPath=\"pages/home/home\",r=i))||r;function Home(){var e,o,i;!function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError(\"Cannot call a class as a function\")}(this,Home);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(o=i=_possibleConstructorReturn(this,(e=Home.__proto__||Object.getPrototypeOf(Home)).call.apply(e,[this].concat(n)))).$usedState=[\"anonymousState__temp\",\"anonymousState__temp2\",\"loopArray40\",\"$compid__105\",\"styles\",\"hasRecord\",\"exitPopup\",\"companyList\",\"userInfo\",\"globalStore\"],i.enterShop=function(o){var t=o.companyId,e=i.$router.params.mark,n=i.props.globalStore,r=n.data.userInfo;if(!r.token)return r.companyId=o.companyId,r.shopId=o.shopId,r.shopName=o.shopName,n.setData(\"userInfo\",r,\"home.jsx,line:47\"),void u.default.switchTab({\"url\":\"/pages/index/index\"});var a=e&&\"undefined\"!==e?\"/pages/invitecode/invitecode?mark=\"+e+\"&shopId=\"+o.shopId:\"/pages/invitecode/invitecode?shopId=\"+o.shopId;m.default.login.existMemberByCompanyId({\"companyId\":t}).then(function(e){i.logger({\"logs\":\"判断是否是店铺会员\",\"api_url\":\"/userservice/shopMember/existMemberByCompanyId\",\"api_req\":JSON.stringify({\"companyId\":t}),\"api_res\":JSON.stringify(e)}),e?i.resetCompanyInfo(o.shopId):!1===e&&u.default.navigateTo({\"url\":a})})},i.resetCompanyInfo=function(o){var t=i.props.globalStore,n=t.data.userInfo;m.default.common.refreshUserToken({\"shopId\":o}).then(function(e){i.logger({\"logs\":\"更新缓存的店铺信息\",\"api_url\":\"/userservice/shopMember/refreshUserToken\",\"api_req\":JSON.stringify({\"shopId\":o}),\"api_res\":JSON.stringify(e)}),e&&(n.companyId=e.companyId,n.shopId=e.shopId,n.shopName=e.shopName,n.companyName=e.companyName,t.setData(\"userInfo\",n,\"home.jsx,line:60\"),u.default.switchTab({\"url\":\"/pages/index/index\"}))})},i.initData=function(){m.default.login.getRecommendShopList().then(function(e){if(i.logger({\"logs\":\"获取店铺列表\",\"api_url\":\"/userservice/shopSearch/getRecommendShopList\",\"api_res\":JSON.stringify(e)}),e&&e.length){var o=[].concat(function _toConsumableArray(e){if(Array.isArray(e)){for(var o=0,t=Array(e.length);o<e.length;o++)t[o]=e[o];return t}return Array.from(e)}(e)).map(function(e){var o=e.goodsInfoList.slice(0,6);return e.goodsInfoList=o,e});i.setState({\"companyList\":o})}})},i.clickAvatar=function(){i.props.globalStore.data.userInfo.token?i.showExitPopup():i.gotoLogin()},i.showExitPopup=function(){var e=i.state.exitPopup;i.setState({\"exitPopup\":!e})},i.onExit=function(){var e=i.props.globalStore,o=e.data.userInfo,t=i.getCompanyId();i.setState({\"exitPopup\":!1}),o.token=\"\",e.setData(\"userInfo\",o,\"setting.jsx,line:50\"),_.$ajax.uninjectHeaders(),_.$ajax.injectHeaders((0,l.getFetchHeader)(!0)),d({\"params\":{\"companyId\":t},\"desc\":\"[system] file:home.jsx line:132\"})},i.gotoLogin=function(){d({\"params\":{\"companyId\":i.getCompanyId()},\"desc\":\"[system] file:home.jsx line:141\"})},i.config={\"navigationBarTitleText\":\"康小铺\"},i.anonymousFunc0Map={},i.customComponents=[\"Ellipsis\"],_possibleConstructorReturn(i,o)}o.default=f,Component(t(0).default.createComponent(f,!0))},\"167\":function(e,o,t){e.exports=t.p+\"pages/home/home.wxml\"},\"250\":function(e,o,t){\"use strict\";t.r(o);t(251);var n=t(89);for(var r in n)\"default\"!==r&&function(e){t.d(o,e,function(){return n[e]})}(r)},\"251\":function(e,o,t){\"use strict\";t(167)},\"252\":function(e,o,t){e.exports={\"container\":\"home-module__container___1NSnh\",\"reset_btn\":\"home-module__reset_btn___3_5bb\",\"header\":\"home-module__header___3xAmv\",\"headerLeft\":\"home-module__headerLeft___1Fqhb\",\"headerName\":\"home-module__headerName___FwOnR\",\"headerExtra\":\"home-module__headerExtra___1-JS8\",\"headerImg\":\"home-module__headerImg___g_H6u\",\"exit\":\"home-module__exit___35Kh9\",\"exitIcon\":\"home-module__exitIcon___24-gp\",\"exitLabel\":\"home-module__exitLabel___2f4dR\",\"body\":\"home-module__body___1NkC3\",\"bodyHeader\":\"home-module__bodyHeader___d4ZQq\",\"bodyHeaderImg\":\"home-module__bodyHeaderImg___ZJ54K\",\"bodyTitle\":\"home-module__bodyTitle___1MFXi\",\"bodyContent\":\"home-module__bodyContent___2IX6W\",\"listItem\":\"home-module__listItem___9Fgl8\",\"imgBlur\":\"home-module__imgBlur___7vrry\",\"itemHeader\":\"home-module__itemHeader___mfP2C\",\"itemLogo\":\"home-module__itemLogo___3KTT_\",\"itemName\":\"home-module__itemName___1-PGI\",\"shopName\":\"home-module__shopName___2oBjC\",\"jdLogo\":\"home-module__jdLogo___3lNFm\",\"itemContent\":\"home-module__itemContent___Xid0c\",\"itemBody\":\"home-module__itemBody___7uFH_\",\"imgContainer\":\"home-module__imgContainer___2Bi4z\",\"bodyImg\":\"home-module__bodyImg___1WR0D\",\"imgExtra\":\"home-module__imgExtra___1zXP0\",\"itemBtn\":\"home-module__itemBtn___2EvUQ\"}},\"89\":function(e,o,t){\"use strict\";t.r(o);var n=t(15),r=t.n(n);for(var a in n)\"default\"!==a&&function(e){t.d(o,e,function(){return n[e]})}(a);o.default=r.a}},[[250,0,1,2,3]]]);","extractedComments":[]}