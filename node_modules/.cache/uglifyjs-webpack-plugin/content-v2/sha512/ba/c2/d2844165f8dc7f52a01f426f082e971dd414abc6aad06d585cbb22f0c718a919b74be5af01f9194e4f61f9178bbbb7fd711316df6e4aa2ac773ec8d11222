{"code":"(wx.webpackJsonp=wx.webpackJsonp||[]).push([[67],{\"169\":function(e,t,o){e.exports=o.p+\"pages/pre-login/pre-login.wxml\"},\"17\":function(e,t,o){\"use strict\";Object.defineProperty(t,\"__esModule\",{\"value\":!0});var f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var o=[],n=!0,r=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw i}}return o}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")},n=function(e,t,o){return t&&defineProperties(e.prototype,t),o&&defineProperties(e,o),e};function defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,i,a,d=o(0),l=_interopRequireDefault(d),s=_interopRequireDefault(o(1)),u=o(2),_=_interopRequireDefault(u),m=_interopRequireDefault(o(6)),h=o(3),v=_interopRequireDefault(o(4)),y=_interopRequireDefault(o(258));function _interopRequireDefault(e){return e&&e.__esModule?e:{\"default\":e}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var c=(0,s.default)((function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{\"constructor\":{\"value\":e,\"enumerable\":!1,\"writable\":!0,\"configurable\":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PreLogin,l.default.Component),n(PreLogin,[{\"key\":\"_constructor\",\"value\":function _constructor(e){(function get(e,t,o){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,t,o)}if(\"value\"in n)return n.value;var i=n.get;return void 0!==i?i.call(o):void 0})(PreLogin.prototype.__proto__||Object.getPrototypeOf(PreLogin.prototype),\"_constructor\",this).call(this,e),this.state={\"params\":{},\"agreeVisible\":!1,\"isAgree\":!1},v.default.appUtils.delay(this,[\"phoneLogin\"]),this.$$refs=new l.default.RefsArray}},{\"key\":\"componentWillReact\",\"value\":function componentWillReact(){}},{\"key\":\"componentDidMount\",\"value\":function componentDidMount(){l.default.showShareMenu({\"withShareTicket\":!0}),l.default.updateShareMenu({\"withShareTicket\":!0})}},{\"key\":\"componentWillUnmount\",\"value\":function componentWillUnmount(){}},{\"key\":\"componentDidShow\",\"value\":function componentDidShow(){}},{\"key\":\"componentDidHide\",\"value\":function componentDidHide(){}},{\"key\":\"_createData\",\"value\":function _createData(e,t,o){this.__state=e||this.state||{},this.__props=t||this.props||{};var n=this.$prefix,r=(0,d.genCompid)(n+\"$compid__89\"),i=f(r,2),a=i[0],l=i[1],s=this.__props.globalStore,u=this.__state,c=u.agreeVisible,p=(u.isAgree,s.data.envUserInfo),g=v.default.appUtils.getFileUrl(m.default.register.logoF,{\"w\":196}),_=v.default.appUtils.getFileUrl(m.default.register.desc,{\"w\":369});return d.propsManager.set({\"isOpened\":c,\"onClose\":this.hideAgreeModal},l,a),Object.assign(this.__state,{\"anonymousState__temp\":g,\"anonymousState__temp2\":_,\"$compid__89\":l,\"styles\":y.default,\"envUserInfo\":p}),this.__state}}]),a=i=PreLogin,i.$$events=[\"getPhoneNumber\",\"phoneLogin\",\"handleAgreement\",\"showAgreeDetail\"],i.$$componentPath=\"pages/pre-login/pre-login\",r=a))||r;function PreLogin(){var e,t,g;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,PreLogin);for(var o=arguments.length,n=Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=g=_possibleConstructorReturn(this,(e=PreLogin.__proto__||Object.getPrototypeOf(PreLogin)).call.apply(e,[this].concat(n)))).$usedState=[\"anonymousState__temp\",\"anonymousState__temp2\",\"$compid__89\",\"styles\",\"isAgree\",\"envUserInfo\",\"params\",\"agreeVisible\",\"globalStore\"],g.handleAgreement=function(){var e=g.state.isAgree;g.setState({\"isAgree\":!e})},g.phoneLogin=function(){if(g.state.isAgree){var e=g.$router.params,t=h.Common.queryString(e||{});l.default.navigateTo({\"url\":\"/pages/login/login\"+(t?\"?\"+t:\"\")})}else h.message.error(\"请先勾选用户服务协议\")},g.getPhoneNumber=function(e){if(g.state.isAgree){g.logger({\"logs\":\"getPhoneNumber返回结果\",\"api_res\":JSON.stringify(e.detail)});var t=g.props.globalStore,o=t.data.envUserInfo,n=o.userInfoEcryptData,r=o.userInfoIv,i=o.openId,a=o.mobilePhone,l=e.detail,s=l.encryptedData,u=l.errMsg,c=l.iv;if(a)g.wechatLoginAction(o);else if(\"getPhoneNumber:ok\"===u){var p={\"phoneEcryptData\":s,\"phoneIv\":c,\"userInfoEcryptData\":n,\"userInfoIv\":r,\"openId\":i};_.default.login.wechatPhone(p).then(function(e){g.logger({\"logs\":\"手机号解密\",\"api_url\":\"/userservice/wechat/wechat-phone\",\"api_req\":JSON.stringify(p),\"api_res\":JSON.stringify(e)}),e&&(o.mobilePhone=e.phone,o.unionId=e.unionId||\"\",g.setState({\"params\":o}),t.setData(\"envUserInfo\",o,\"pre-login.jsx,line:89\"),g.wechatLoginAction(o))})}}else h.message.error(\"请先勾选用户服务协议\")},g.wechatLoginAction=function(o){var n=g.$router.params.mark,r=g.props.globalStore,e=r.data.envUserInfo;e.avatarUrl&&(o.headImgUrl=e.avatarUrl),e.mobilePhone?_.default.login.wechatLoginAction(o).then(function(e){if(g.logger({\"logs\":\"微信授权登录\",\"api_url\":\"/userservice/wechat/wechat-login-c\",\"api_req\":JSON.stringify(o),\"api_res\":JSON.stringify(e)}),e){e.headImg=e.headImg||m.default.common.default_photo,r.setData(\"userInfo\",e,\"pre-login.jsx,line:110\"),h.$ajax.injectHeaders((0,u.getFetchHeader)());var t=l.default.getStorageSync(\"fromUrl\")||\"\";if(l.default.removeStorageSync(\"fromUrl\"),!0===e.needBindInvitation)l.default.navigateTo({\"url\":n?\"/pages/invitecode/invitecode?mark=\"+n:\"/pages/invitecode/invitecode\"});else if(!0===e.needBindShop)l.default.navigateTo({\"url\":\"/pages/home/home\"});else{if(t)0<t.search(/\\/my|\\/contactus|\\/collect/)?l.default.switchTab({\"url\":t}):l.default.navigateTo({\"url\":t});else l.default.switchTab({\"url\":\"/pages/index/index\"})}}}):h.message.error(\"未获取到微信绑定的手机号，请用其他方式登录\")},g.onShareAppMessage=function(e){return g.logger({\"logs\":\"C端分享\"}),{\"title\":\"价低品全质优省事\",\"path\":\"/pages/login-guide/login-guide?companyId=\"+(globalStore.data.userInfo.companyId||\"\"),\"imageUrl\":m.default.common.share_logo,\"success\":function success(e){e.errMsg},\"fail\":function fail(){\"shareAppMessage:fail cancel\"==res.errMsg||res.errMsg},\"complete\":function complete(){}}},g.showAgreeDetail=function(){g.setState({\"agreeVisible\":!0})},g.hideAgreeModal=function(){g.setState({\"agreeVisible\":!1})},g.config={\"navigationBarTitleText\":\"登录\"},g.customComponents=[\"AtModal\",\"AtModalHeader\",\"AtModalContent\",\"Agreement\"],_possibleConstructorReturn(g,t)}t.default=c,Component(o(0).default.createComponent(c,!0))},\"256\":function(e,t,o){\"use strict\";o.r(t);o(257);var n=o(91);for(var r in n)\"default\"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r)},\"257\":function(e,t,o){\"use strict\";o(169)},\"258\":function(e,t,o){e.exports={\"reset_btn\":\"pre-login-module__reset_btn___1d4ck\",\"prelogin_container\":\"pre-login-module__prelogin_container___1esHF\",\"logo\":\"pre-login-module__logo___3NO0w\",\"label\":\"pre-login-module__label___3PeBq\",\"wechat_btn\":\"pre-login-module__wechat_btn___9ltRZ\",\"icon\":\"pre-login-module__icon___25rCX\",\"text\":\"pre-login-module__text___2lOAs\",\"phone_btn\":\"pre-login-module__phone_btn___3R912\",\"footerContainer\":\"pre-login-module__footerContainer___19Xdr\",\"agree_img_container\":\"pre-login-module__agree_img_container___1lzi9\",\"agree_img\":\"pre-login-module__agree_img___JvDHD\",\"disagree_img\":\"pre-login-module__disagree_img___1IT-y\",\"agreement\":\"pre-login-module__agreement___lt9_3\",\"agreement_btn\":\"pre-login-module__agreement_btn___2kTq4\"}},\"91\":function(e,t,o){\"use strict\";o.r(t);var n=o(17),r=o.n(n);for(var i in n)\"default\"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);t.default=r.a}},[[256,0,1,2,3]]]);","extractedComments":[]}