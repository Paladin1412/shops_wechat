{"code":"(wx.webpackJsonp=wx.webpackJsonp||[]).push([[15],{\"159\":function(e,t,o){\"use strict\";o.r(t);var n=o(83),r=o.n(n);for(var i in n)\"default\"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);t.default=r.a},\"219\":function(e,t,o){e.exports=o.p+\"components/upload/index.wxml\"},\"446\":function(e,t,o){\"use strict\";o.r(t);o(447);var n=o(159);for(var r in n)\"default\"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r)},\"447\":function(e,t,o){\"use strict\";o(219)},\"83\":function(e,t,o){\"use strict\";Object.defineProperty(t,\"__esModule\",{\"value\":!0});var m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},v=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var o=[],n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return o}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")},n=function(e,t,o){return t&&defineProperties(e.prototype,t),o&&defineProperties(e,o),e};function defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,i,y=o(0),p=_interopRequireDefault(y),f=o(3),a=o(4),d=_interopRequireDefault(o(2));function _interopRequireDefault(e){return e&&e.__esModule?e:{\"default\":e}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var _=a.appUtils.getFileUrl,h=a.appUtils.navigateToLogin,s=(function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{\"constructor\":{\"value\":e,\"enumerable\":!1,\"writable\":!0,\"configurable\":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Collect,p.default.Component),n(Collect,[{\"key\":\"_constructor\",\"value\":function _constructor(e){(function get(e,t,o){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,t,o)}if(\"value\"in n)return n.value;var i=n.get;return void 0!==i?i.call(o):void 0})(Collect.prototype.__proto__||Object.getPrototypeOf(Collect.prototype),\"_constructor\",this).call(this,e),this.state={\"files\":[],\"isloading\":!1},this.$$refs=new p.default.RefsArray}},{\"key\":\"componentDidMount\",\"value\":function componentDidMount(){}},{\"key\":\"_createData\",\"value\":function _createData(e,t,o){this.__state=e||this.state||{},this.__props=t||this.props||{};var n=this.$prefix,r=(0,y.genCompid)(n+\"$compid__169\"),i=v(r,2),a=i[0],s=i[1],l=(0,y.genCompid)(n+\"$compid__170\"),c=v(l,2),u=c[0],p=c[1],f=this.__state,d=f.files,_=f.isloading,h=d.length<(this.__props.size||1);return y.propsManager.set(m({\"files\":d,\"showAddBtn\":h},this.__props.option,{\"onImageClick\":this.click,\"onChange\":this.onChangeFile}),s,a),y.propsManager.set({\"isOpened\":_,\"text\":\"正在上传\",\"icon\":\"loading\",\"status\":\"loading\",\"duration\":0},p,u),Object.assign(this.__state,{\"anonymousState__temp\":h,\"$compid__169\":s,\"$compid__170\":p}),this.__state}}]),i=r=Collect,r.$$events=[],r.$$componentPath=\"components/upload/index\",i);function Collect(){var e,t,u;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,Collect);for(var o=arguments.length,n=Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=u=_possibleConstructorReturn(this,(e=Collect.__proto__||Object.getPrototypeOf(Collect)).call.apply(e,[this].concat(n)))).$usedState=[\"anonymousState__temp\",\"$compid__169\",\"$compid__170\",\"files\",\"isloading\",\"maxSize\",\"showList\",\"option\",\"size\"],u.click=function(){u.props.onClick&&u.props.onClick()},u.onChangeFile=function(e,t,o){var r=u.state.files;if(\"remove\"===t&&(r.splice(o,1),u.setState({\"files\":r}),u.props.onRemove(o)),\"add\"===t&&e){var n=e.slice(-1),i=n[0].file.size,a=n[0].file.path.split(\".\"),s=a[a.length-1],l=u.props.maxSize;if(\"number\"==typeof l&&l<i){var c=1<l/1024/1024?l/1024/1024+\"M\":l/1024+\"KB\";return f.message.error(\"上传文件大小已超过\"+c),!1}u.setState({\"isloading\":!0}),p.default.uploadFile({\"url\":d.default.common.upload(),\"name\":\"file\",\"filePath\":n[0].file.path,\"header\":{\"token\":p.default.getStorageSync(\"userInfo\").token||\"\"},\"formData\":{\"extension\":s}}).then(function(e){var t=JSON.parse(e.data),o=t.entry,n=t.responseCode;o?(!1!==u.props.showList&&r.push({\"url\":_(o.filePath)}),u.setState({\"files\":r,\"isloading\":!1},function(){u.props.onSuccess(o.filePath)})):\"\"+n!=\"1000010003\"&&\"\"+n!=\"1000010001\"&&\"\"+n!=\"1000010002\"||h({\"desc\":\"[system] file:cmpt/upload.jsx line:80\"})})}},u.config={\"navigationBarTitleText\":\"\"},u.customComponents=[\"AtImagePicker\",\"AtToast\"],_possibleConstructorReturn(u,t)}t.default=s,Component(o(0).default.createComponent(s))}},[[446,0,1,2,3]]]);","extractedComments":[]}